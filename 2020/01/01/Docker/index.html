<!DOCTYPE html>
<html lang="zh-CN">
<head>

  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"lqy679.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Docker 参考文档:💻 Docker 快速安装软件 - Docker 快速入门 - 易文档 (easydoc.net) 官方文档:Docker Documentation 官网:Docker  常见问题解决: (61条消息) 【已解决】Error: Failed to download metadata for repo ‘appstream‘: Cannot prepare interna">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker">
<meta property="og:url" content="https://lqy679.github.io/2020/01/01/Docker/index.html">
<meta property="og:site_name" content="南城记录倌">
<meta property="og:description" content="Docker 参考文档:💻 Docker 快速安装软件 - Docker 快速入门 - 易文档 (easydoc.net) 官方文档:Docker Documentation 官网:Docker  常见问题解决: (61条消息) 【已解决】Error: Failed to download metadata for repo ‘appstream‘: Cannot prepare interna">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/kv7rlicu.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216085921561.png">
<meta property="og:image" content="https://sjwx.easydoc.xyz/46901064/files/l25jdwrn.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216091015101.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216094432646.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216104902663.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216163024810.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216203118412.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216204523681.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216220526846.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216220603794.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216220623731.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221216223048722.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217110542073.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217110941949.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113713903.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113737706.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113749785.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113817848.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113838378.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113411614.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221217113456800.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218000138880.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218002108621.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218002129091.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218004121846.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218004651207.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218004855003-16712957366981.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005044116.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005326603.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005400773.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005520373.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005621694.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218005731719.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010121967-16712964830762.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010139808.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010238586.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010355425.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010636602.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010733995.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010901675.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010912112.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218010922685.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218094758456.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218094822453.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218094837357.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095043425.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095054908.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095339811.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095401453.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095445291.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095502887.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095528464.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095616371.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095627995.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095811968.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095825486.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095839094.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095850255.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218095901726.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218192835688.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218192855022.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218193057218.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218193203743.png">
<meta property="og:image" content="https://lqy679.github.io/2020/01/01/Docker/image-20221218193223636.png">
<meta property="article:published_time" content="2020-01-01T10:57:32.000Z">
<meta property="article:modified_time" content="2023-04-28T03:23:48.812Z">
<meta property="article:author" content="Luo Qianyou">
<meta property="article:tag" content="Java,Python,web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lqy679.github.io/2020/01/01/Docker/kv7rlicu.png">


<link rel="canonical" href="https://lqy679.github.io/2020/01/01/Docker/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://lqy679.github.io/2020/01/01/Docker/","path":"2020/01/01/Docker/","title":"Docker"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Docker | 南城记录倌</title>
  








  <!--
    引用自作者
    <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
  -->
  <script src="/live2d-widget/autoload.js"></script>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">
      <img class="custom-logo-image" src="/site_images/logo.jpg" alt="南城记录倌">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">南城记录倌</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">往昔皆为过眼云烟,一切尽随风而逝;此刻之行终将化未来的救赎之刃</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">10</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">32</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker"><span class="nav-number">1.</span> <span class="nav-text">Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="nav-number">1.1.</span> <span class="nav-text">常见问题解决:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.2.</span> <span class="nav-text">简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%9F%E6%99%AE%E9%80%9A%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="nav-number">1.2.1.</span> <span class="nav-text">跟普通虚拟机的对比</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E3%80%81%E5%88%86%E5%8F%91%E3%80%81%E9%83%A8%E7%BD%B2"><span class="nav-number">1.2.2.</span> <span class="nav-text">打包、分发、部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="nav-number">1.2.3.</span> <span class="nav-text">部署的优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E5%B8%B8%E7%94%A8%E6%9D%A5%E5%81%9A%E4%BB%80%E4%B9%88"><span class="nav-number">1.2.4.</span> <span class="nav-text">通常用来做什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5%EF%BC%9A%E9%95%9C%E5%83%8F%E3%80%81%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.5.</span> <span class="nav-text">重要概念：镜像、容器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E6%9E%B6%E6%9E%84-%E5%BE%85%E5%AD%A6"><span class="nav-number">1.3.</span> <span class="nav-text">原理以及架构(待学)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E7%9A%84%E4%B8%89%E4%B8%AA%E6%A6%82%E5%BF%B5"><span class="nav-number">1.3.1.</span> <span class="nav-text">Docker的三个概念</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">1.4.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8Window%E4%B8%AD%E5%AE%89%E8%A3%85"><span class="nav-number">1.4.1.</span> <span class="nav-text">在Window中安装</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F%E6%BA%90"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">配置镜像加速源</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8Linux%E4%B8%AD%E5%AE%89%E8%A3%85-%E9%87%8D%E7%82%B9"><span class="nav-number">1.4.2.</span> <span class="nav-text">在Linux中安装(重点):</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">准备工作:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">1.4.2.1.1.</span> <span class="nav-text">关闭防火墙:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B3%E9%97%ADSelinux"><span class="nav-number">1.4.2.1.2.</span> <span class="nav-text">关闭Selinux:</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E8%A3%85wget"><span class="nav-number">1.4.2.1.3.</span> <span class="nav-text">安装wget</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E6%8D%A2yum%E9%95%9C%E5%83%8F%E6%BA%90"><span class="nav-number">1.4.2.1.4.</span> <span class="nav-text">更换yum镜像源</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7"><span class="nav-number">1.4.2.1.5.</span> <span class="nav-text">安装一些工具</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEstable%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="nav-number">1.4.2.1.6.</span> <span class="nav-text">设置stable镜像仓库</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85docker"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">安装docker</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">1.5.</span> <span class="nav-text">镜像命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.5.1.</span> <span class="nav-text">常用命令:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.6.</span> <span class="nav-text">容器命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">创建容器与配置</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%8D%B7"><span class="nav-number">1.6.0.1.1.</span> <span class="nav-text">容器卷</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8D%B7%E7%9A%84%E7%BB%A7%E6%89%BF%E5%92%8C%E5%85%B1%E4%BA%AB"><span class="nav-number">1.6.0.1.1.1.</span> <span class="nav-text">卷的继承和共享:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E4%BA%A4%E4%BA%92%E5%91%BD%E4%BB%A4"><span class="nav-number">1.6.0.2.</span> <span class="nav-text">容器交互命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E5%AE%B9%E5%99%A8"><span class="nav-number">1.6.0.2.1.</span> <span class="nav-text">退出容器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E5%90%8E%E5%8F%B0%E5%AE%B9%E5%99%A8"><span class="nav-number">1.6.0.2.2.</span> <span class="nav-text">进入后台容器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E4%B8%8E%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%80%9A%E4%BF%A1"><span class="nav-number">1.6.0.2.3.</span> <span class="nav-text">容器与宿主机通信</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E5%91%BD%E4%BB%A4"><span class="nav-number">1.6.0.3.</span> <span class="nav-text">更多命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%AF%BC%E5%87%BA%E4%B8%8E%E5%AF%BC%E5%85%A5"><span class="nav-number">1.6.0.3.1.</span> <span class="nav-text">容器导出与导入:</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6"><span class="nav-number">1.7.</span> <span class="nav-text">部署常用软件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85mysql"><span class="nav-number">1.7.1.</span> <span class="nav-text">安装mysql</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E6%88%98%E9%83%A8%E7%BD%B2"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">实战部署</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Tomcat"><span class="nav-number">1.7.2.</span> <span class="nav-text">安装Tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Redis"><span class="nav-number">1.7.3.</span> <span class="nav-text">安装Redis</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dockerfile"><span class="nav-number">1.8.</span> <span class="nav-text">Dockerfile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA"><span class="nav-number">1.8.1.</span> <span class="nav-text">构建:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B%E8%A7%A3%E6%9E%90"><span class="nav-number">1.8.1.1.</span> <span class="nav-text">构建过程解析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E4%BF%9D%E7%95%99%E5%AD%97"><span class="nav-number">1.8.2.</span> <span class="nav-text">常用保留字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-number">1.8.3.</span> <span class="nav-text">案例:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%86%E5%A4%87%E5%A5%BD%E9%9C%80%E8%A6%81%E6%89%93%E5%8C%85%E7%9A%84%E6%96%87%E4%BB%B6"><span class="nav-number">1.8.3.1.</span> <span class="nav-text">准备好需要打包的文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA"><span class="nav-number">1.8.3.2.</span> <span class="nav-text">打包构建</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%83%A8%E7%BD%B2"><span class="nav-number">1.9.</span> <span class="nav-text">微服务部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-Compose"><span class="nav-number">1.10.</span> <span class="nav-text">Docker-Compose</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Compose%E4%BD%BF%E7%94%A8%E7%9A%84%E4%B8%89%E4%B8%AA%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.10.1.</span> <span class="nav-text">Compose使用的三个步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B-1"><span class="nav-number">1.10.2.</span> <span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-number">1.10.2.1.</span> <span class="nav-text">补充:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Compose%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.10.3.</span> <span class="nav-text">Compose常用命令:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E7%BD%91%E7%BB%9C"><span class="nav-number">1.11.</span> <span class="nav-text">Docker网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bridge%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.11.1.</span> <span class="nav-text">Bridge模式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B-2"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">案例:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#host%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.11.2.</span> <span class="nav-text">host模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#none%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.11.3.</span> <span class="nav-text">none模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#container%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.11.4.</span> <span class="nav-text">container模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="nav-number">1.11.5.</span> <span class="nav-text">自定义网络</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="nav-number">1.11.5.1.</span> <span class="nav-text">相关命令:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B-3"><span class="nav-number">1.11.5.2.</span> <span class="nav-text">案例:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Harbor%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA"><span class="nav-number">1.12.</span> <span class="nav-text">Harbor私有镜像仓库搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Harbor"><span class="nav-number">1.12.1.</span> <span class="nav-text">安装Harbor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.12.2.</span> <span class="nav-text">修改配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC"><span class="nav-number">1.12.3.</span> <span class="nav-text">执行安装脚本:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E9%A1%B5%E5%8F%AF%E8%A7%86%E5%8C%96%E8%AE%BF%E9%97%AE"><span class="nav-number">1.12.4.</span> <span class="nav-text">网页可视化访问:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">1.12.4.1.</span> <span class="nav-text">新建项目</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F%E6%8E%A8%E9%80%81harbor"><span class="nav-number">1.12.5.</span> <span class="nav-text">本地镜像推送harbor</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker%E7%99%BB%E5%BD%95%E5%88%B0harbor"><span class="nav-number">1.12.5.1.</span> <span class="nav-text">docker登录到harbor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E9%A6%96%E5%85%88%E7%A1%AE%E8%AE%A4%E9%95%9C%E5%83%8F%E5%AD%98%E5%9C%A8"><span class="nav-number">1.12.5.2.</span> <span class="nav-text">(1)首先确认镜像存在</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%87%8D%E5%91%BD%E5%90%8D%E9%95%9C%E5%83%8F"><span class="nav-number">1.12.5.3.</span> <span class="nav-text">(2)重命名镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E6%8E%A8%E9%80%81%E5%88%B0harbor%E4%B8%8A"><span class="nav-number">1.12.5.4.</span> <span class="nav-text">(3)推送到harbor上</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%89%E5%8F%96harbor%E9%95%9C%E5%83%8F"><span class="nav-number">1.12.6.</span> <span class="nav-text">拉取harbor镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%A9%E7%94%A8docker%E7%99%BB%E5%BD%95%E5%88%B0harbor"><span class="nav-number">1.12.6.1.</span> <span class="nav-text">(1)利用docker登录到harbor</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%9C%A8%E7%BD%91%E9%A1%B5%E4%B8%8A%E7%82%B9%E5%87%BB%E8%A6%81%E6%8B%89%E5%8F%96%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">1.12.6.2.</span> <span class="nav-text">(2)在网页上点击要拉取的镜像</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#docker%E5%8F%AF%E8%A7%86%E5%8C%96web%E5%B7%A5%E5%85%B7"><span class="nav-number">1.13.</span> <span class="nav-text">docker可视化web工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4"><span class="nav-number">1.13.1.</span> <span class="nav-text">安装步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%B8%AA%E9%83%A8%E7%BD%B2"><span class="nav-number">1.13.2.</span> <span class="nav-text">单个部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="nav-number">1.13.2.1.</span> <span class="nav-text">创建局域网</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2mysql"><span class="nav-number">1.13.2.2.</span> <span class="nav-text">部署mysql</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2redis"><span class="nav-number">1.13.2.3.</span> <span class="nav-text">部署redis</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A0%86%E7%A7%AF%E9%83%A8%E7%BD%B2"><span class="nav-number">1.13.3.</span> <span class="nav-text">堆积部署</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%9B%E5%BB%BA%E5%A0%86%E5%8F%A0%E5%AE%B9%E5%99%A8"><span class="nav-number">1.13.3.1.</span> <span class="nav-text">1.创建堆叠容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%91%BD%E5%90%8D"><span class="nav-number">1.13.3.2.</span> <span class="nav-text">2.命名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">1.13.3.3.</span> <span class="nav-text">3.编写配置文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E5%90%AF%E5%8A%A8%E9%83%A8%E7%BD%B2"><span class="nav-number">1.13.3.4.</span> <span class="nav-text">4.启动部署</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Luo Qianyou"
      src="/site_images/logo.jpg">
  <p class="site-author-name" itemprop="name">Luo Qianyou</p>
  <div class="site-description" itemprop="description">清醒,知趣 明得失,知进退</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">32</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/LQY679" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;LQY679" rel="noopener me" target="_blank"><i class="fa-brands fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/QianyouLuo" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;QianyouLuo" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://example.com/" title="https:&#x2F;&#x2F;example.com" rel="noopener" target="_blank">Title</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://lqy679.github.io/2020/01/01/Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/site_images/logo.jpg">
      <meta itemprop="name" content="Luo Qianyou">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="南城记录倌">
      <meta itemprop="description" content="清醒,知趣 明得失,知进退">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Docker | 南城记录倌">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-01-01 18:57:32" itemprop="dateCreated datePublished" datetime="2020-01-01T18:57:32+08:00">2020-01-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-04-28 11:23:48" itemprop="dateModified" datetime="2023-04-28T11:23:48+08:00">2023-04-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%BF%90%E7%BB%B4/" itemprop="url" rel="index"><span itemprop="name">运维</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><blockquote>
<p>参考文档:<a target="_blank" rel="noopener" href="https://docker.easydoc.net/doc/81170005/cCewZWoN/AWOEX9XM">💻 Docker 快速安装软件 - Docker 快速入门 - 易文档 (easydoc.net)</a></p>
<p>官方文档:<a target="_blank" rel="noopener" href="https://docs.docker.com/">Docker Documentation</a></p>
<p>官网:<a target="_blank" rel="noopener" href="https://www.docker.com/">Docker</a></p>
</blockquote>
<h2 id="常见问题解决"><a href="#常见问题解决" class="headerlink" title="常见问题解决:"></a>常见问题解决:</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43252521/article/details/124409151">(61条消息) 【已解决】Error: Failed to download metadata for repo ‘appstream‘: Cannot prepare internal mirrorlist_ReadThroughLife的博客-CSDN博客</a></p>
<p>或:<a target="_blank" rel="noopener" href="https://blog.csdn.net/Indra_ran/article/details/123817631?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-123817631-blog-124409151.pc_relevant_landingrelevant&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-2-123817631-blog-124409151.pc_relevant_landingrelevant&utm_relevant_index=3">(61条消息) CentOSyum安装报错“Error: Failed to download metadata for repo ‘AppStream‘: xxxx”_Indra_ran的博客-CSDN博客</a></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 容器 bash 没有 clear命令</span></span><br><span class="line">dnf install ncurses -y</span><br><span class="line"><span class="comment"># 查看容器CentOS 系统版本</span></span><br><span class="line"><span class="built_in">cat</span> /etc/redhat-release</span><br><span class="line"><span class="comment"># 无法下载东西,容器需要配置镜像源</span></span><br><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d/</span><br><span class="line">sed -i <span class="string">&#x27;s/mirrorlist/#mirrorlist/g&#x27;</span> /etc/yum.repos.d/CentOS-*</span><br><span class="line">sed -i <span class="string">&#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27;</span> /etc/yum.repos.d/CentOS-*</span><br><span class="line"></span><br><span class="line">yum makecache <span class="comment"># 建立yum缓存</span></span><br><span class="line"><span class="comment"># an&#x27;zhung</span></span><br><span class="line">yum update -y</span><br><span class="line">yum -y install vim</span><br><span class="line">yum -y install net-tools</span><br></pre></td></tr></table></figure>

<p>也可以通过Dockerfile打包镜像,Dockerfile内容如下:</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos</span><br><span class="line"><span class="keyword">ENV</span> mypath /tmp</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$mypath</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /etc/yum.repos.d/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/mirrorlist/#mirrorlist/g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum makecache</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum update -y</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install vim</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&#x27;to be not success running&#x27;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&#x27;success------ok&#x27;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /bin/bash</span></span><br></pre></td></tr></table></figure>



<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p><strong>Docker 是什么</strong></p>
<p>Docker 是一个应用打包、分发、部署的工具<br>你也可以把它理解为一个轻量的虚拟机，它只虚拟你软件需要的运行环境，多余的一点都不要，<br>而普通虚拟机则是一个完整而庞大的系统，包含各种不管你要不要的软件。</p>
<h3 id="跟普通虚拟机的对比"><a href="#跟普通虚拟机的对比" class="headerlink" title="跟普通虚拟机的对比"></a>跟普通虚拟机的对比</h3><table>
<thead>
<tr>
<th>特性</th>
<th>普通虚拟机</th>
<th>Docker</th>
</tr>
</thead>
<tbody><tr>
<td>跨平台</td>
<td>通常只能在桌面级系统运行，例如 Windows/Mac，无法在不带图形界面的服务器上运行</td>
<td>支持的系统非常多，各类 windows 和 Linux 都支持</td>
</tr>
<tr>
<td>性能</td>
<td>性能损耗大，内存占用高，因为是把整个完整系统都虚拟出来了</td>
<td>性能好，只虚拟软件所需运行环境，最大化减少没用的配置</td>
</tr>
<tr>
<td>自动化</td>
<td>需要手动安装所有东西</td>
<td>一个命令就可以自动部署好所需环境</td>
</tr>
<tr>
<td>稳定性</td>
<td>稳定性不高，不同系统差异大</td>
<td>稳定性好，不同系统都一样部署方式</td>
</tr>
</tbody></table>
<h3 id="打包、分发、部署"><a href="#打包、分发、部署" class="headerlink" title="打包、分发、部署"></a>打包、分发、部署</h3><p><strong>打包</strong>：就是把你软件运行所需的依赖、第三方库、软件打包到一起，变成一个安装包<br><strong>分发</strong>：你可以把你打包好的“安装包”上传到一个镜像仓库，其他人可以非常方便的获取和安装<br><strong>部署</strong>：拿着“安装包”就可以一个命令运行起来你的应用，自动模拟出一摸一样的运行环境，不管是在 Windows/Mac/Linux。<br><img src="kv7rlicu.png" alt="image.png"></p>
<h3 id="部署的优势"><a href="#部署的优势" class="headerlink" title="部署的优势"></a>部署的优势</h3><p>常规应用开发部署方式：自己在 Windows 上开发、测试 –&gt; 到 Linux 服务器配置运行环境部署。</p>
<blockquote>
<p>问题：我机器上跑都没问题，怎么到服务器就各种问题了</p>
</blockquote>
<p>用 Docker 开发部署流程：自己在 Windows 上开发、测试 –&gt; 打包为 Docker 镜像（可以理解为软件安装包） –&gt; 各种服务器上只需要一个命令部署好</p>
<blockquote>
<p>优点：确保了不同机器上跑都是一致的运行环境，不会出现我机器上跑正常，你机器跑就有问题的情况。</p>
</blockquote>
<p>例如 <a target="_blank" rel="noopener" href="https://easydoc.net/">易文档</a>，<a target="_blank" rel="noopener" href="https://svnbucket.com/">SVNBucket</a> 的私有化部署就是用 Docker，轻松应对客户的各种服务器。</p>
<h3 id="通常用来做什么"><a href="#通常用来做什么" class="headerlink" title="通常用来做什么"></a>通常用来做什么</h3><ul>
<li>应用分发、部署，方便传播给他人安装。特别是开源软件和提供私有部署的应用</li>
<li>快速安装测试/学习软件，用完就丢（类似小程序），不把时间浪费在安装软件上。例如 Redis / MongoDB / ElasticSearch / ELK</li>
<li>多个版本软件共存，不污染系统，例如 Python2、Python3，Redis4.0，Redis5.0</li>
<li>Windows 上体验/学习各种 Linux 系统</li>
</ul>
<h3 id="重要概念：镜像、容器"><a href="#重要概念：镜像、容器" class="headerlink" title="重要概念：镜像、容器"></a>重要概念：镜像、容器</h3><p><strong>镜像</strong>：可以理解为软件安装包，可以方便的进行传播和安装。<br><strong>容器</strong>：软件安装后的状态，每个软件运行环境都是独立的、隔离的，称之为容器。</p>
<h2 id="原理以及架构-待学"><a href="#原理以及架构-待学" class="headerlink" title="原理以及架构(待学)"></a>原理以及架构(待学)</h2><h3 id="Docker的三个概念"><a href="#Docker的三个概念" class="headerlink" title="Docker的三个概念"></a>Docker的三个概念</h3><ol>
<li><strong>镜像（Image）</strong>：类似于虚拟机中的镜像，是一个包含有文件系统的面向Docker引擎的只读模板。任何应用程序运行都需要环境，而镜像就是用来提供这种运行环境的。例如一个Ubuntu镜像就是一个包含Ubuntu操作系统环境的模板，同理在该镜像上装上Apache软件，就可以称为Apache镜像。</li>
<li><strong>容器（Container）</strong>：类似于一个轻量级的沙盒，可以将其看作一个极简的Linux系统环境（包括root权限、<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E8%BF%9B%E7%A8%8B%E7%A9%BA%E9%97%B4&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%2223599229%22%7D">进程空间</a>、用户空间和网络空间等），以及运行在其中的应用程序。Docker引擎利用容器来运行、隔离各个应用。容器是镜像创建的应用实例，可以创建、启动、停止、删除容器，各个容器之间是是相互隔离的，互不影响。注意：镜像本身是只读的，容器从镜像启动时，Docker在镜像的上层创建一个<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E5%8F%AF%E5%86%99%E5%B1%82&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%2223599229%22%7D">可写层</a>，镜像本身不变。</li>
<li><strong>仓库（Repository）</strong>：类似于代码仓库，这里是镜像仓库，是Docker用来集中存放<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%2223599229%22%7D">镜像文件</a>的地方。注意与<a target="_blank" rel="noopener" href="https://www.zhihu.com/search?q=%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1%E5%99%A8&search_source=Entity&hybrid_search_source=Entity&hybrid_search_extra=%7B%22sourceType%22:%22article%22,%22sourceId%22:%2223599229%22%7D">注册服务器</a>（Registry）的区别：注册服务器是存放仓库的地方，一般会有多个仓库；而仓库是存放镜像的地方，一般每个仓库存放一类镜像，每个镜像利用tag进行区分，比如Ubuntu仓库存放有多个版本（12.04、14.04等）的Ubuntu镜像。</li>
</ol>
<p><img src="image-20221216085921561.png" alt="image-20221216085921561"></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="在Window中安装"><a href="#在Window中安装" class="headerlink" title="在Window中安装"></a>在Window中安装</h3><p>桌面版：<a target="_blank" rel="noopener" href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a><br>服务器版：<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/#server">https://docs.docker.com/engine/install/#server</a></p>
<h4 id="配置镜像加速源"><a href="#配置镜像加速源" class="headerlink" title="配置镜像加速源"></a>配置镜像加速源</h4><p><img src="https://sjwx.easydoc.xyz/46901064/files/l25jdwrn.png" alt="img"></p>
<table>
<thead>
<tr>
<th>镜像加速器</th>
<th>镜像加速器地址</th>
</tr>
</thead>
<tbody><tr>
<td>Docker 中国官方镜像</td>
<td><a target="_blank" rel="noopener" href="https://registry.docker-cn.com/">https://registry.docker-cn.com</a></td>
</tr>
<tr>
<td>DaoCloud 镜像站</td>
<td><a target="_blank" rel="noopener" href="http://f1361db2.m.daocloud.io/">http://f1361db2.m.daocloud.io</a></td>
</tr>
<tr>
<td>Azure 中国镜像</td>
<td><a target="_blank" rel="noopener" href="https://dockerhub.azk8s.cn/">https://dockerhub.azk8s.cn</a></td>
</tr>
<tr>
<td>科大镜像站</td>
<td><a target="_blank" rel="noopener" href="https://docker.mirrors.ustc.edu.cn/">https://docker.mirrors.ustc.edu.cn</a></td>
</tr>
<tr>
<td>阿里云</td>
<td>https://<your_code>.mirror.aliyuncs.com</your_code></td>
</tr>
<tr>
<td>七牛云</td>
<td><a target="_blank" rel="noopener" href="https://reg-mirror.qiniu.com/">https://reg-mirror.qiniu.com</a></td>
</tr>
<tr>
<td>网易云</td>
<td><a target="_blank" rel="noopener" href="https://hub-mirror.c.163.com/">https://hub-mirror.c.163.com</a></td>
</tr>
<tr>
<td>腾讯云</td>
<td><a target="_blank" rel="noopener" href="https://mirror.ccs.tencentyun.com/">https://mirror.ccs.tencentyun.com</a></td>
</tr>
</tbody></table>
<h3 id="在Linux中安装-重点"><a href="#在Linux中安装-重点" class="headerlink" title="在Linux中安装(重点):"></a>在Linux中安装(重点):</h3><blockquote>
<p>视频教程:<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Md4y1t7xS?p=4&vd_source=a67b19bba4b2eebaa16b72d8dfcfc061">哔哩哔哩_bilibili</a></p>
<p>官方文档: <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
</blockquote>
<h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作:"></a>准备工作:</h4><h5 id="关闭防火墙"><a href="#关闭防火墙" class="headerlink" title="关闭防火墙:"></a><strong>关闭防火墙:</strong></h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#关闭防火墙(临时关闭)</span></span><br><span class="line">systemctl stop firewalld</span><br><span class="line"><span class="comment">#永久关闭防火墙</span></span><br><span class="line">systemctl <span class="built_in">disable</span> firewalld</span><br><span class="line"><span class="comment">#查看防火墙状态</span></span><br><span class="line">systemctl status firewalld</span><br></pre></td></tr></table></figure>

<h5 id="关闭Selinux"><a href="#关闭Selinux" class="headerlink" title="关闭Selinux:"></a><strong>关闭Selinux:</strong></h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#打开配置文件:</span></span><br><span class="line">vim /etc/selinux/config</span><br><span class="line"><span class="comment">#找到设置项并设置为: SELINUX=disable</span></span><br></pre></td></tr></table></figure>

<h5 id="安装wget"><a href="#安装wget" class="headerlink" title="安装wget"></a><strong>安装wget</strong></h5><p><code>wget</code>命令是Linux系统用于从Web下载文件的命令行工具，支持 HTTP、HTTPS及FTP协议下载文而且wget还提供了很多选项，例如下载多个文件、后台下载，使用代理等等，使用非常方便。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install wget -y </span><br></pre></td></tr></table></figure>

<h5 id="更换yum镜像源"><a href="#更换yum镜像源" class="headerlink" title="更换yum镜像源"></a><strong>更换yum镜像源</strong></h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入下载源配置目录</span></span><br><span class="line"><span class="built_in">cd</span> /etc/yum.repos.d/</span><br><span class="line"><span class="comment">#创建一个备份文件夹</span></span><br><span class="line"><span class="built_in">mkdir</span> repo-bk</span><br><span class="line"><span class="comment">#将原来的配置源文件移动到备份文件夹中</span></span><br><span class="line"><span class="built_in">mv</span> *.repo repo-bk/</span><br><span class="line"><span class="comment">#下载镜像源</span></span><br><span class="line">wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span><br><span class="line"><span class="comment">#清空并重新更新一下缓存</span></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>

<h5 id="安装一些工具"><a href="#安装一些工具" class="headerlink" title="安装一些工具"></a><strong>安装一些工具</strong></h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#(按需安装) 安装vim编辑器和查询网卡的工具</span></span><br><span class="line">yum install -y vim net-tools.x86_64</span><br><span class="line">yum -y install gcc</span><br><span class="line">yum -y install gcc-c++</span><br><span class="line"><span class="comment">#工具包</span></span><br><span class="line">yum install -y yum-utils</span><br><span class="line"><span class="comment">#更新缓存</span></span><br><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>

<h5 id="设置stable镜像仓库"><a href="#设置stable镜像仓库" class="headerlink" title="设置stable镜像仓库"></a>设置stable镜像仓库</h5><p>需要设置是因为yum软件源是没有docker</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#docker官网(不推荐)</span></span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line"><span class="comment">#推荐使用阿里云镜像</span></span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">yum makecache fast <span class="comment">#更新软件源索引</span></span><br></pre></td></tr></table></figure>



<h4 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装docker</span></span><br><span class="line">yum -y install docker-ce docker-ce-cli containerd.io</span><br><span class="line"><span class="comment">#启动</span></span><br><span class="line">systemctl start docker</span><br><span class="line"><span class="comment">#设置开机自启</span></span><br><span class="line">systemctl <span class="built_in">enable</span> docker </span><br><span class="line"><span class="comment">#测试docker是否安装成功</span></span><br><span class="line">docker version  <span class="comment">#查看版本与信息</span></span><br><span class="line">docker info</span><br><span class="line"><span class="comment">#测试(第一次过程需要从仓库拉取有些慢,需要耐心等待)</span></span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure>

<p><strong>普通用户免root运行docker</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在普通用户在</span></span><br><span class="line">su <span class="comment">#切换到root用户</span></span><br><span class="line"><span class="comment">#添加组</span></span><br><span class="line">groupadd docker</span><br><span class="line"><span class="comment">#修改普通用户所属组</span></span><br><span class="line">usermod -aG docker 普通用户名</span><br><span class="line"><span class="comment">#重启docker</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="comment">#重启使用修改生效</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p><strong>配置阿里云镜像加速</strong></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors">容器镜像服务 (aliyun.com)</a></p>
</blockquote>
<p>需要到阿里云登陆账号:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> -p /etc/docker</span><br><span class="line">sudo <span class="built_in">tee</span> /etc/docker/daemon.json &lt;&lt;-<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;registry-mirrors&quot;</span>: [<span class="string">&quot;https://eh05r18s.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>



<h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><p><img src="image-20221216091015101.png" alt="image-20221216091015101"></p>
<h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令:"></a>常用命令:</h3><p>注: [options] 表示可选命令参数, tag代表镜像的版本</p>
<p>可以通过<a target="_blank" rel="noopener" href="https://hub.docker.com/">hub.docker </a>查看详细的镜像以及版本号</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker images <span class="comment">#查看本地镜像列表</span></span><br><span class="line">docker search [options] 镜像名 <span class="comment">#查找仓库中镜像,命令参数:  -limit n 指定列出的镜像数,默认25</span></span><br><span class="line">docker pull 镜像名[:tag]    <span class="comment">#从仓库中下载镜像到本地,可以在镜像名后追加标签号指定版本,不加是最新版</span></span><br><span class="line">docker push 镜像名  <span class="comment">#上传镜像到仓库</span></span><br><span class="line">docker rmi [options] 镜像名或镜像<span class="built_in">id</span> <span class="comment">#删除指定的镜像,添加命令参数-f,可以通过镜像id删除或者删除多个</span></span><br><span class="line"><span class="comment">#删除多个: docker rmi 镜像id 镜像id</span></span><br><span class="line"><span class="comment">#删除全部镜像:docker rmi `docker images -q`</span></span><br><span class="line"><span class="comment"># 重命名镜像</span></span><br><span class="line">docker image tag fb583c3ac45d  my_docker/test:latest</span><br></pre></td></tr></table></figure>



<h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2><p><img src="image-20221216094432646.png" alt="image-20221216094432646"></p>
<p>注意: 以下所说的容器名其实写容器id也可以,不过多赘述</p>
<p><strong>有镜像才能创建容器,这是前提</strong></p>
<p>以下例子    用Nginx和CentOS演示:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx <span class="comment">#从仓库下载一个Nginx镜像</span></span><br><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>

<h4 id="创建容器与配置"><a href="#创建容器与配置" class="headerlink" title="创建容器与配置"></a>创建容器与配置</h4><p><code>docker run [OPTIONS] image [COMMAND] [ARG...]</code></p>
<p><strong>OPTIONS说明（常用）</strong>：有些是一个减号，有些是两个减号:</p>
<p><code>-i</code>：以交互模式运行容器，<strong>通常与 -t 同时使用；</strong></p>
<p><code>-t</code>：为容器重新分配一个伪输入终端</p>
<p>上面两个<strong>一般配合使用,并且大部分情况下是必须的</strong></p>
<p><code>-d</code>: <strong>后台运行容器并返回容器ID</strong>，也即启动守护式容器(后台运行),在<strong>大多数情况下,我们是希望Docker服务后台运行的</strong></p>
<p><code>--name</code> “容器名字”  给容器定义个名字,不写则随机生成</p>
<p><code>-p</code>: <strong>指定</strong>端口映射，小写p  </p>
<p><code>-P</code>: <strong>随机</strong>端口映射，大写P</p>
<p><img src="image-20221216104902663.png" alt="image-20221216104902663"></p>
<p>例子:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#前台启动Nginx,开启端口映射</span></span><br><span class="line">docker run -it --name nginxContainer -p 8080:80 nginx</span><br><span class="line"><span class="comment">#在Docker中启动一个CentOS虚拟机</span></span><br><span class="line">docker run -it --name centosContainer centos</span><br></pre></td></tr></table></figure>

<p>tips:</p>
<p><img src="image-20221216163024810.png" alt="image-20221216163024810"></p>
<p><code>-v</code>命令参数涉及到容器卷的概念:</p>
<h5 id="容器卷"><a href="#容器卷" class="headerlink" title="容器卷"></a>容器卷</h5><p>即将容器内部的文件路径与宿主机文件路径进行关联,(即每当容器或者宿主机关联的文件进行关联,修改其中一个,另一个也会改变)</p>
<p>我们将其操作称之为<strong>容器卷挂载</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it -v /宿主机绝对路径目录:/容器内目录 镜像名</span><br></pre></td></tr></table></figure>

<p>查看数据卷是否挂载成功,通过<code>docker inspect 容器ID</code>查看容器细节</p>
<p><img src="image-20221216203118412.png" alt="image-20221216203118412"></p>
<p><strong>补充</strong>:</p>
<p>读写映射规则设置:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#默认rw</span></span><br><span class="line">docker run -it --privileged=<span class="literal">true</span> -v /宿主机绝对路径目录:/容器内目录:rw</span><br><span class="line"></span><br><span class="line"><span class="comment">#容器实例内部被限制，只能读取不能写</span></span><br><span class="line">docker run -it --privileged=<span class="literal">true</span> -v /宿主机绝对路径目录:/容器内目录:ro 镜像名</span><br></pre></td></tr></table></figure>

<h6 id="卷的继承和共享"><a href="#卷的继承和共享" class="headerlink" title="卷的继承和共享:"></a>卷的继承和共享:</h6><p><img src="image-20221216204523681.png" alt="image-20221216204523681"></p>
<p><strong>实现:</strong></p>
<p><code>docker run -it --privileged=true --volumes-from 父类容器 --name 容器名 镜像</code></p>
<p>参数说明:</p>
<p><code>--privileged=true</code> 用于解决文件权限问题</p>
<p><code>--volumes-from</code>指定继承的父类容器</p>
<h4 id="容器交互命令"><a href="#容器交互命令" class="headerlink" title="容器交互命令"></a>容器交互命令</h4><h5 id="退出容器"><a href="#退出容器" class="headerlink" title="退出容器"></a>退出容器</h5><p>==当使用run进入容器后:==</p>
<p>使用快捷键:<code>ctrl+p+q 或 ctrl +p ctrl q</code>退出，<strong>容器不停止</strong></p>
<p>输入命令: <code>exit</code>退出，<strong>容器停止</strong></p>
<h5 id="进入后台容器"><a href="#进入后台容器" class="headerlink" title="进入后台容器"></a>进入后台容器</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it 容器ID bash <span class="comment">#推荐使用</span></span><br><span class="line">docker attach 容器ID</span><br></pre></td></tr></table></figure>

<p>上述两者的区别:</p>
<p><code>exec</code> 是在容器中打开新的终端，并且可以启动新的进程,<strong>用exit退出，不会导致容器的停止</strong></p>
<p><code>attach</code> 直接进入容器启动命令的终端，不会启动新的进程,<strong>用exit退出，会导致容器的停止</strong>。</p>
<h5 id="容器与宿主机通信"><a href="#容器与宿主机通信" class="headerlink" title="容器与宿主机通信"></a>容器与宿主机通信</h5><p>容器-&gt;宿主机</p>
<p><code>docker cp 容器ID:容器内路径 目的主机路径</code></p>
<p>宿主机-&gt;容器</p>
<p><code>docker cp 宿主机路径 容器ID:容器内路径</code></p>
<h4 id="更多命令"><a href="#更多命令" class="headerlink" title="更多命令"></a>更多命令</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">docker ps [options] <span class="comment">#查看正在运行的容器</span></span><br><span class="line"><span class="comment">#options命令参数: -a 查看所有的参数, -q 只查看容器id</span></span><br><span class="line">docker start 容器ID或者容器名  <span class="comment">#启动已停止的容器</span></span><br><span class="line">docker restart 容器ID或者容器名  <span class="comment">#重启容器</span></span><br><span class="line">docker stop 容器ID或者容器名  <span class="comment">#停止容器</span></span><br><span class="line">docker <span class="built_in">kill</span> 容器ID或容器名  <span class="comment"># 强制停止容器</span></span><br><span class="line">docker <span class="built_in">rm</span> 容器ID  <span class="comment">#删除已经停止的容器</span></span><br><span class="line"><span class="comment">#补充: 删除全部容器docker rm `docker ps -a -q`</span></span><br><span class="line"></span><br><span class="line">docker logs 容器ID  <span class="comment">#查看容器的日志</span></span><br><span class="line">docker top 容器ID   <span class="comment">#查看容器运行的进程</span></span><br><span class="line">docker inspect 容器ID  <span class="comment">#查看容器内部细节</span></span><br></pre></td></tr></table></figure>

<h5 id="容器导出与导入"><a href="#容器导出与导入" class="headerlink" title="容器导出与导入:"></a>容器导出与导入:</h5><p>我们可以将自己的<strong>容器打包成一个镜像</strong>了,也可<strong>引入打包好的容器文件为作为一个镜像(包含被包的容器的所有数据)</strong></p>
<p><code>docker export 容器ID &gt; 文件名.tar</code></p>
<p><code>docker import 文件名.tar 镜像名:镜像版本号</code> </p>
<h2 id="部署常用软件"><a href="#部署常用软件" class="headerlink" title="部署常用软件"></a>部署常用软件</h2><blockquote>
<p>搜索镜像:<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com/</a></p>
</blockquote>
<p>总体分二步:</p>
<ol>
<li><strong>搜索拉取镜像</strong></li>
<li><strong>创建容器</strong></li>
</ol>
<h3 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h3><blockquote>
<p>参考:<a target="_blank" rel="noopener" href="https://hub.docker.com/_/mysql">mysql - Official Image | Docker Hub</a></p>
</blockquote>
<p>拉取好镜像后,启动mysql服务</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -itd --name some-mysql -e MYSQL_ROOT_PASSWORD=设置的密码 -p 3306:3306  mysql:tag</span><br></pre></td></tr></table></figure>

<p>不过上述方案存在一个问题:<strong>即删除容器会导致数据丢失</strong></p>
<h4 id="实战部署"><a href="#实战部署" class="headerlink" title="实战部署"></a>实战部署</h4><p>通过<strong>挂载mysql容器卷</strong>来实现数据解决上述问题</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 3306:3306 --privileged=<span class="literal">true</span> -v /opt/mysql/log:/var/log/mysql -v /opt/mysql/data:/var/lib/mysql -v /opt/mysql/conf:/etc/mysql/conf.d -e MYSQL_ROOT_PASSWORD=123456  --name mysql mysql:5.7</span><br></pre></td></tr></table></figure>



<h3 id="安装Tomcat"><a href="#安装Tomcat" class="headerlink" title="安装Tomcat"></a>安装Tomcat</h3><p>跟上述同理,不过最新版有个bug,无法正常进入首页,把webapps..dist目录命名为webapps即可</p>
<h3 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h3><p>注: Redis的配置文件可以从网上下载到,例如github:<a target="_blank" rel="noopener" href="https://github.com/redis/redis/blob/6.0.8/redis.conf">https://github.com/redis/redis/blob/6.0.8/redis.conf</a>, 切换到对应版本即可</p>
<ol>
<li>首先,创建一个存放配置文件的目录: <code>mkdir -p /opt/redis</code></li>
<li><strong>redis.conf文件用xftp传输到/opt/redis目录下</strong></li>
<li>/opt/redis目录下修改redis.conf文件</li>
</ol>
<p><img src="image-20221216220526846.png" alt="image-20221216220526846"></p>
<p><img src="image-20221216220603794.png" alt="image-20221216220603794"></p>
<p><img src="image-20221216220623731.png" alt="image-20221216220623731"></p>
<p><strong>最后挂载容器卷创建运行容器</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run  -p 6379:6379 --name redis --privileged=<span class="literal">true</span> -v /opt/redis/redis.conf:/etc/redis/redis.conf -v /opt/redis/data:/data -d redis:6.0.8 redis-server /etc/redis/redis.conf</span><br></pre></td></tr></table></figure>



<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfile是用来构建Docker镜像的文本文件，是由<strong>一条条构建镜像所需的指令和参数构成的脚本。</strong></p>
<h3 id="构建"><a href="#构建" class="headerlink" title="构建:"></a>构建:</h3><p>三个步骤:</p>
<p>1.编写Dockerfile文件 </p>
<p>2.<code>docker build</code>命令构建镜像 </p>
<p>3.docker run依镜像运行容器实例</p>
<h4 id="构建过程解析"><a href="#构建过程解析" class="headerlink" title="构建过程解析"></a>构建过程解析</h4><p>每条保留字指令都<strong>必须为大写字母</strong>且后面要<strong>跟随至少一个参数</strong></p>
<p>指令按照从上到下，顺序执行</p>
<p>#表示注释</p>
<p><strong>每条指令都会创建一个新的镜像层并对镜像进行提交</strong></p>
<h3 id="常用保留字"><a href="#常用保留字" class="headerlink" title="常用保留字"></a>常用保留字</h3><p><img src="image-20221216223048722.png" alt="image-20221216223048722"></p>
<h3 id="案例"><a href="#案例" class="headerlink" title="案例:"></a>案例:</h3><p>下面的案例将构建一个带有Java环境和<code>ifconfig</code>命令的CentOS系统</p>
<h4 id="准备好需要打包的文件"><a href="#准备好需要打包的文件" class="headerlink" title="准备好需要打包的文件"></a>准备好需要打包的文件</h4><p>即jdk , <strong>注意jdk需要放到与Dockerfile文件同级目录下</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建一个存放构建镜像的目录</span></span><br><span class="line"><span class="built_in">mkdir</span> /opt/centos</span><br><span class="line"><span class="comment">#新建并编写一个Dockerfile文件, 注意D一定要是大写 (内容在后面)</span></span><br><span class="line">vim Dockerfile</span><br></pre></td></tr></table></figure>

<p><code>Dockerfile</code>文件内容</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#基础镜像,即从什么镜像开始构建</span></span><br><span class="line"><span class="keyword">FROM</span> centos:latest</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置最新yum镜像仓库地址</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /etc/yum.repos.d/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/mirrorlist/#mirrorlist/g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27;</span> /etc/yum.repos.d/CentOS-*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum makecache</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置镜像默认工作路径,即进入容器后会默认来到这个目录 </span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /usr/local</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#安装ifconfig网络工具</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#安装 Java8依赖库</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install glibc.i686</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建java的路径</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> /usr/local/java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将java安装包添加到容器中</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> jdk-8u171-linux-x64.tar.gz /usr/local/java</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置Java环境变量</span></span><br><span class="line"><span class="keyword">ENV</span> JAVA_HOME /usr/local/java/jdk1.<span class="number">8.0</span>_171</span><br><span class="line"><span class="keyword">ENV</span> JRE_HOME $JAVA_HOME/jre</span><br><span class="line"><span class="keyword">ENV</span> CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib:$CLASSPATH</span><br><span class="line"><span class="keyword">ENV</span> PATH $JAVA_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;success......ok&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /bin/bash</span></span><br></pre></td></tr></table></figure>

<h4 id="打包构建"><a href="#打包构建" class="headerlink" title="打包构建"></a>打包构建</h4><p>在准备好文件和Dockerfile后就可以使用命令打包了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 镜像名:TAG(版本号) . <span class="comment">#注意后面有个. 千万不能漏,代表当前目录</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可以查看镜像的构建历史日志</span></span><br><span class="line">docker <span class="built_in">history</span> 镜像名</span><br></pre></td></tr></table></figure>

<p>随后用此镜像创建运行centos容器就可以执行<code>ifconfig</code> 和<code>java</code>相关的命令</p>
<h2 id="微服务部署"><a href="#微服务部署" class="headerlink" title="微服务部署"></a>微服务部署</h2><p>假设已经有开发好的SpringBoot应用jar包</p>
<p>我们需要打包构建一个镜像,并用如下的<code>Dockerfile</code>脚本进行构建镜像</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根据java8构建镜像</span></span><br><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"><span class="comment">#默认工作目录</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /opt/java</span></span><br><span class="line"><span class="comment">#添加jar包</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> docker-springboot-1.0-SNAPSHOT.jar /opt/java</span></span><br><span class="line"><span class="comment">#暴露端口</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">6002</span></span><br><span class="line"><span class="comment">#执行命令(不会被覆盖)</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-jar&quot;</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/opt/java/docker-springboot-1.0-SNAPSHOT.jar&quot;</span>] </span></span><br><span class="line"><span class="comment">#当执行docker run 时的 bash默认参数,可被命令参数覆盖,即不写默认执行:</span></span><br><span class="line"><span class="comment">#docker run -itd --name 容器名 java -jar /opt/java/docker-springboot-1.0-SNAPSHOT.jar</span></span><br><span class="line"><span class="comment">#写了就会将其替换为:</span></span><br><span class="line"><span class="comment">#docker run -itd --name 容器名 java -jar 自己写的参数</span></span><br></pre></td></tr></table></figure>

<p>随后构建微服务的镜像:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 镜像名:TAG(版本号) .</span><br></pre></td></tr></table></figure>

<p>然后<code>docker run ...</code> 即可启动服务</p>
<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker-Compose"></a>Docker-Compose</h2><p>Docker-Compose是Docker官方的开源项目，<strong>负责实现对Docker容器集群的快速编排。</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装</span></span><br><span class="line">yum install -y docker-compose-plugin</span><br><span class="line"><span class="comment">#检查是否安装成功</span></span><br><span class="line">docker compose version</span><br></pre></td></tr></table></figure>



<h3 id="Compose使用的三个步骤"><a href="#Compose使用的三个步骤" class="headerlink" title="Compose使用的三个步骤"></a>Compose使用的三个步骤</h3><ol>
<li>编写<code>Dockerfile</code>定义各个微服务应用并<strong>构建出对应的镜像文件</strong></li>
<li>使用 <code>docker-compose.yml</code>，定义一个完整业务单元，<strong>安排好整体应用中的各个容器服务执行顺序</strong>。</li>
<li>最后，执行<code>docker compose up</code>命令 来<strong>启动并运行整个应用程序，完成一键部署上线</strong></li>
</ol>
<h3 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h3><p>下面将演示一个简单的SpringBoot应用依赖于MySQL和redisf服务的部署过程</p>
<p>即 <strong>要先启动MySQL 和 redis 服务后,再启动Springboot服务</strong></p>
<p>首先编写<code>Dockerfile</code>定义各个微服务应用并<strong>构建出对应的镜像文件</strong></p>
<p><code>Dockerfile</code>内容</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> java:<span class="number">8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /opt/java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> docker-springboot-1.0-SNAPSHOT.jar /opt/java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">6002</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-jar&quot;</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/opt/java/docker-springboot-1.0-SNAPSHOT.jar&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p>随后构建镜像: <code>docker build -t 镜像名:版本号</code></p>
<blockquote>
<p>yaml文件语法: <a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43340943/article/details/105953673?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-105953673-blog-100577740.pc_relevant_3mothn_strategy_recovery&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-1-105953673-blog-100577740.pc_relevant_3mothn_strategy_recovery&utm_relevant_index=2">yaml语法</a></p>
</blockquote>
<p>然后编写<code>docker-compose.yml</code>文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#compose版本</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="comment">#compose需要组合编排的服务: springboot应用,mysql,redis</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="comment">#springboot服务的相关配置</span></span><br><span class="line">  <span class="attr">docker-springboot:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">docker-springboot:latest</span>   <span class="comment">#用哪个镜像docker run容器</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">docker-springboot</span>  <span class="comment">#定义创建的容器名</span></span><br><span class="line">    <span class="attr">ports:</span>  <span class="comment">#暴漏端口: 相当于 docker run -p 6001:6001</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6001:6001&quot;</span></span><br><span class="line">    <span class="attr">networks:</span>  <span class="comment">#所属compose创建的局域网</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ptu202180</span> </span><br><span class="line">    <span class="attr">depends_on:</span>   <span class="comment">#依赖的服务,即只有依赖的服务启动后,才会启动该服务</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">      </span><br><span class="line">  <span class="comment">#redis服务的相关配置</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis:6.0.8</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span> <span class="comment">#相当于 docker run -v 的挂载容器卷</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/redis/redis.conf:/etc/redis/redis.conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/opt/redis/data:/data</span></span><br><span class="line">    <span class="attr">networks:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">ptu202180</span></span><br><span class="line">    <span class="comment">#使用配置文件启动redis命令  </span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">/etc/redis/redis.conf</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="comment">#设置mysql登陆密码,数据库等</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">&#x27;123456&#x27;</span></span><br><span class="line">      <span class="attr">MYSQL_ALLOW_EMPTY_PASSWORD:</span> <span class="string">&#x27;no&#x27;</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">&#x27;ptu&#x27;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">/opt/mysql/data:/var/lib/mysql</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">/opt/mysql/conf/my.cnf:/etc/my.cnf</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">/opt/mysql/init:/docker-entrypoint-initdb.d</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">/opt/mysql/log:/var/log/mysql</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ptu202180</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--default-authentication-plugin=mysql_native_password</span> <span class="comment">#解决外部无法访问</span></span><br><span class="line"><span class="comment">#组件局域网,名为ptu202180    </span></span><br><span class="line"><span class="attr">networks:</span> </span><br><span class="line">   <span class="attr">ptu202180:</span> </span><br></pre></td></tr></table></figure>

<p>最后组合创建并执行排编好的微服务,注意<strong>执行<code> docker compose up</code>命令目录必须与docker-compose.yml一致</strong></p>
<p>也可以使用 <code>-d </code>命令参数后台运行</p>
<h4 id="补充"><a href="#补充" class="headerlink" title="补充:"></a>补充:</h4><p><code>docker-compose.yml</code>文件中的<code>networks</code>配置项用于在一个compose编排的微服务中<strong>构建一个内部共享的局域网,即:其内部的各个服务(springboot,mysql,redis)处于同一局域网下可以互相访问</strong> <em><strong>(注: 详细原理请看docker 网络的自定义网络)</strong></em></p>
<p>那么我们的springboot的mysql等数据库的连接配置就不必写成:</p>
<p><code>jdbc:mysql://IP地址:3306/bike_db?serverTimezone=Asia/Shanghai</code></p>
<p>而是<strong>可以用服务名代替</strong>,即:</p>
<p><code>jdbc:mysql://服务名(本例中是:mysql):3306/bike_db?serverTimezone=Asia/Shanghai</code></p>
<h3 id="Compose常用命令"><a href="#Compose常用命令" class="headerlink" title="Compose常用命令:"></a>Compose常用命令:</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker compose up                           <span class="comment"># 启动所有docker-compose服务</span></span><br><span class="line">docker compose up -d                        <span class="comment"># 启动所有docker-compose服务并后台运行</span></span><br><span class="line">docker compose down                         <span class="comment"># 停止并删除容器、网络、卷、镜像。</span></span><br><span class="line">docker compose stop      <span class="comment"># 停止服务</span></span><br><span class="line">docker compose restart   <span class="comment"># 重启服务</span></span><br><span class="line">docker compose start     <span class="comment"># 启动服务</span></span><br><span class="line">docker compose -h   <span class="comment">#查看帮助   </span></span><br></pre></td></tr></table></figure>



<h2 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h2><p>总体介绍:</p>
<table>
<thead>
<tr>
<th>网络模式</th>
<th>介绍</th>
</tr>
</thead>
<tbody><tr>
<td>bridge模式**(默认模式)**</td>
<td>使用<code>--network bridge</code>指定，默认使用docker0</td>
</tr>
<tr>
<td>host模式</td>
<td>使用<code>--network host</code>指定</td>
</tr>
<tr>
<td>container模式：</td>
<td>使用<code>--network container:NAME</code>或者容器ID指定</td>
</tr>
<tr>
<td>none模式</td>
<td>使用-<code>-network none</code>指定</td>
</tr>
</tbody></table>
<h3 id="Bridge模式"><a href="#Bridge模式" class="headerlink" title="Bridge模式"></a>Bridge模式</h3><p>Docker使用Linux桥接，<strong>在宿主机虚拟一个Docker容器网桥(docker0)<strong>，Docker</strong>启动一个容器时会根据Docker网桥的网段分配给容器一个IP地址</strong>，称为Container-IP，同时<strong>Docker网桥是每个容器的默认网关。因为在同一宿主机内的容器都接入同一个网桥，这样==容器之间就能够通过容器的Container-IP直接通信==。</strong></p>
<p><code>docker run</code> 的时候，<strong>没有指定network的话默认使用的网桥模式就是bridge</strong>，使用的就是docker0。在宿主机<code>ifconfig</code>,就可以看到docker0和自己create的network(后面讲)eth0，eth1，eth2……代表网卡一，网卡二，网卡三……，lo代表127.0.0.1，即localhost，inet addr用来表示网卡的IP地址</p>
<p><strong>网桥docker0创建一对对等虚拟设备接口一个叫veth，另一个叫eth0，成对匹配。</strong></p>
<ol>
<li><p><strong>整个宿主机的网桥模式都是docker0</strong>，类似一个交换机有一堆接口，<strong>每个接口叫veth，在本地主机和容器内分别创建一个虚拟接口，并让他们彼此联通（这样一对接口叫veth pair）</strong>；</p>
</li>
<li><p><strong>每个容器实例内部也有一块网卡，每个接口叫eth0</strong>；</p>
</li>
<li><p><strong>docker0上面的每个veth匹配某个容器实例内部的eth0，两两配对，一一匹配。</strong></p>
</li>
</ol>
<p> 通过上述，将宿主机上的所有容器都连接到这个内部网络上，两个容器在同一个网络下,会从这个网关下各自拿到分配的ip，此时两个容器的网络是互通的。</p>
<p><img src="image-20221217110542073.png" alt="image-20221217110542073"></p>
<p>Docker 服务默认会创建一个 docker0 网桥（其上有一个 docker0 内部接口），该桥接网络的名称为docker0，它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。<strong>Docker 默认指定了 docker0 接口 的 IP 地址和子网掩码，让宿主机和容器之间可以通过网桥相互通信。</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 bridge 网络的详细信息，并通过 grep 获取名称项</span></span><br><span class="line">docker network inspect bridge | grep name</span><br><span class="line"><span class="comment">#查看网卡信息</span></span><br><span class="line">ifconfig</span><br></pre></td></tr></table></figure>

<p><img src="image-20221217110941949.png" alt="image-20221217110941949"></p>
<h4 id="案例-2"><a href="#案例-2" class="headerlink" title="案例:"></a>案例:</h4><p><strong>结论: IP地址随容器顺序递增且动态分配</strong></p>
<p>1 先启动两个ubuntu容器实例</p>
<p><img src="image-20221217113713903.png" alt="image-20221217113713903"></p>
<p>2 <code>docker inspect 容器ID or 容器名字</code></p>
<p><img src="image-20221217113737706.png" alt="image-20221217113737706"></p>
<p><img src="image-20221217113749785.png" alt="image-20221217113749785"></p>
<p>3 关闭u2实例</p>
<p><img src="image-20221217113817848.png" alt="image-20221217113817848"></p>
<p>4 新建u3，查看ip变化</p>
<p><img src="image-20221217113838378.png" alt="image-20221217113838378"></p>
<h3 id="host模式"><a href="#host模式" class="headerlink" title="host模式"></a>host模式</h3><p><strong>直接使用宿主机的 IP 地址与外界进行通信</strong>，不再需要额外进行NAT 转换。</p>
<p>容器将<strong>不会获得一个独立的Network Namespace</strong>， 而是和宿主机共用一个Network Namespace。容器将<strong>不会虚拟出自己的网卡而是使用宿主机的IP和端口。</strong></p>
<p><img src="image-20221217113411614.png" alt="image-20221217113411614"></p>
<p>问题：</p>
<p><img src="image-20221217113456800.png" alt="image-20221217113456800"></p>
<p>   docke启动时总是遇见标题中的警告</p>
<p>原因：</p>
<p>  docker启动时指定<code>--network host或-net=host</code>，如果<strong>还指定了-p映射端口，那这个时候就会有此警告</strong>，</p>
<p>并且<strong>通过<code>-p</code>设置的参数将不会起到任何作用，端口号会以主机端口号为主</strong>，<strong>重复时则递增</strong>。</p>
<p>解决:</p>
<p>  解决的办法就是<strong>使用docker的其他网络模式</strong>，例如<code>--network=bridge</code>，这样就可以解决问题，或者直接无视。</p>
<h3 id="none模式"><a href="#none模式" class="headerlink" title="none模式"></a>none模式</h3><p>在none模式下，并**不为Docker容器进行任何网络配置(禁用网络功能)**。 也就是说，这个Docker容器没有网卡、IP、路由等信息，只有一个lo</p>
<p>需要我们自己为Docker容器添加网卡、配置IP等。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8084:8080 --network none --name 容器名 镜像名</span><br></pre></td></tr></table></figure>



<h3 id="container模式"><a href="#container模式" class="headerlink" title="container模式"></a>container模式</h3><p><strong>新建的容器和已经存在的一个容器共享一个网络ip配置</strong>而不是和宿主机共享。<strong>新创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围等</strong>。同样，两个容器<strong>除了网络方面，其他的如文件系统、进程列表等还是隔离的。</strong></p>
<p><img src="image-20221218000138880.png" alt="image-20221218000138880"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建容器2,并且与已经存在的容器1共享网卡,同时也无法与宿主机进行端口映射</span></span><br><span class="line">docker run -it --network container:容器1 --name 容器2 镜像名 bash</span><br></pre></td></tr></table></figure>



<h3 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h3><p>我们可以通过<code>docker network create 网络名</code>自定义<strong>创建一个局部网来实现容器名(服务名)与其容器的IP地址绑定</strong>,即可以使用服务名来代表该服务容器的ip地址,自定义网络默认使用的是桥接(Bridge)模式</p>
<h4 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令:"></a>相关命令:</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker network <span class="built_in">ls</span> <span class="comment">#查看所有的网络(列表)</span></span><br><span class="line">docker network create 网络名 <span class="comment">#创建网络</span></span><br></pre></td></tr></table></figure>

<h4 id="案例-3"><a href="#案例-3" class="headerlink" title="案例:"></a>案例:</h4><p><img src="image-20221218002108621.png" alt="image-20221218002108621"></p>
<p><img src="image-20221218002129091.png" alt="image-20221218002129091"></p>
<h2 id="Harbor私有镜像仓库搭建"><a href="#Harbor私有镜像仓库搭建" class="headerlink" title="Harbor私有镜像仓库搭建"></a>Harbor私有镜像仓库搭建</h2><p><strong>硬件要求:</strong></p>
<p><img src="image-20221218004121846.png" alt="image-20221218004121846"></p>
<h3 id="安装Harbor"><a href="#安装Harbor" class="headerlink" title="安装Harbor"></a>安装Harbor</h3><p>1.在opt下创建文件夹harbor</p>
<p>2.上传安装包到harbor文件夹下</p>
<p>3.上传安装包到harbor文件夹下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在/opt/harbor目录下执行!</span></span><br><span class="line"><span class="built_in">cp</span> harbor.yml.tmpl  harbor.yml</span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/harbor/data     <span class="comment">#用于存放harbor的持久化数据</span></span><br></pre></td></tr></table></figure>

<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p><strong>harbor.yml配置文件主要修改参数如下：</strong></p>
<p><img src="image-20221218004651207.png" alt="image-20221218004651207"></p>
<p>设置内容:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置主机地址，可以使用ip、域名，不可以设置为127.0.0.1或localhost。默认情况下，harbor使用的端口是80</span></span><br><span class="line"><span class="attr">hostname:</span> <span class="number">192.168</span><span class="number">.0</span><span class="number">.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#http配置</span></span><br><span class="line"><span class="attr">http:</span></span><br><span class="line"><span class="comment"># port for http, default is 80. If https enabled, this port will redirect to https port</span></span><br><span class="line"><span class="attr">port:</span> <span class="number">9999</span></span><br><span class="line"><span class="comment">#https配置（如不需要可不配置,注释掉）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https related config</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#https:</span></span><br><span class="line"><span class="comment"># https port for harbor, default is 443</span></span><br><span class="line"> <span class="comment">#port: 443</span></span><br><span class="line"><span class="comment"># The path of cert and key files for nginx</span></span><br><span class="line"> <span class="comment">#certificate: /your/certificate/path</span></span><br><span class="line"> <span class="comment">#private_key: /your/private/key/path</span></span><br><span class="line"><span class="comment">#external_url: https://reg.mydomain.com:8433      //如果要启用外部代理,比如外层的NGINX、LB等，请取消注释external_url,当它启用时，hostname将不再使用。</span></span><br></pre></td></tr></table></figure>

<p><img src="image-20221218004855003-16712957366981.png" alt="image-20221218004855003"></p>
<p>数据库配置:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数据库配置</span></span><br><span class="line"><span class="attr">database:</span></span><br><span class="line"><span class="comment"># The password for the root user of Harbor DB. Change this before any production use.</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">root123</span></span><br><span class="line"><span class="comment"># The maximum number of connections in the idle connection pool. If it &lt;=0, no idle connections are retained.</span></span><br><span class="line"><span class="attr">max_idle_conns:</span> <span class="number">50</span></span><br><span class="line"><span class="comment"># The maximum number of open connections to the database. If it &lt;= 0, then there is no limit on the number of open connections.</span></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> the default number of connections is 100 for postgres.</span></span><br><span class="line"><span class="attr">max_open_conns:</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p><strong>持久化数据目录:</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data_volume:</span> <span class="string">/opt/harbor/data</span></span><br></pre></td></tr></table></figure>

<p><img src="image-20221218005044116.png" alt="image-20221218005044116"></p>
<h3 id="执行安装脚本"><a href="#执行安装脚本" class="headerlink" title="执行安装脚本:"></a>执行安装脚本:</h3><p>在<code>/opt/harbor/</code>目录下,执行 <code>./install.sh</code></p>
<h3 id="网页可视化访问"><a href="#网页可视化访问" class="headerlink" title="网页可视化访问:"></a>网页可视化访问:</h3><p><img src="image-20221218005326603.png" alt="image-20221218005326603"></p>
<h4 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h4><p><img src="image-20221218005400773.png" alt="image-20221218005400773"></p>
<h3 id="本地镜像推送harbor"><a href="#本地镜像推送harbor" class="headerlink" title="本地镜像推送harbor"></a>本地镜像推送harbor</h3><h4 id="docker登录到harbor"><a href="#docker登录到harbor" class="headerlink" title="docker登录到harbor"></a>docker登录到harbor</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login ip地址:harbor端口</span><br></pre></td></tr></table></figure>

<p><strong>可能出现错误:</strong></p>
<p><img src="image-20221218005520373.png" alt="image-20221218005520373"></p>
<p><strong>原因：</strong>Docker自从1.3.X之后docker registry交互默认使用的是HTTPS，但是我们搭建私有镜像默认使用的是HTTP服务，所以与私有镜像交时出现以上错误。</p>
<p><strong>解决方案：</strong></p>
<p>修改docker配置文件</p>
<p><code>vim /etc/docker/daemon.json</code></p>
<p>添加行：<code>&quot;insecure-registries&quot;:[&quot;IP地址:harbor端口&quot;]</code></p>
<p><img src="image-20221218005621694.png" alt="image-20221218005621694"></p>
<p>随后执行命令:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#重新加载docker配置</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"></span><br><span class="line"><span class="comment">#重启docker</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"></span><br><span class="line"><span class="comment">#重新启动harbor</span></span><br><span class="line"><span class="built_in">cd</span> /opt/harbor/harbor</span><br><span class="line">docker-compose down</span><br><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>

<p>重新利用docker登录到harbor，显示登录成功：</p>
<p><img src="image-20221218005731719.png" alt="image-20221218005731719"></p>
<p><strong>对本地镜像进行重新命名，命名要求参考harbor指示：</strong></p>
<p><img src="image-20221218010121967-16712964830762.png" alt="image-20221218010121967"></p>
<p><img src="image-20221218010139808.png" alt="image-20221218010139808"></p>
<p>比如我们<strong>想把hello-world镜像推到harbor，</strong>具体过程如下：</p>
<h4 id="1-首先确认镜像存在"><a href="#1-首先确认镜像存在" class="headerlink" title="(1)首先确认镜像存在"></a>(1)首先确认镜像存在</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure>

<p><img src="image-20221218010238586.png" alt="image-20221218010238586"></p>
<h4 id="2-重命名镜像"><a href="#2-重命名镜像" class="headerlink" title="(2)重命名镜像"></a><strong>(2)重命名镜像</strong></h4><p><strong>按harbor命名要求重新给hello-world命名</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dokcer tag hello-world 仓库IP地址:harbor端口/项目名/推送的镜像名:版本</span><br></pre></td></tr></table></figure>

<p><img src="image-20221218010355425.png" alt="image-20221218010355425"></p>
<h4 id="3-推送到harbor上"><a href="#3-推送到harbor上" class="headerlink" title="(3)推送到harbor上"></a><strong>(3)推送到harbor上</strong></h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull 按规范命名好的镜像名</span><br></pre></td></tr></table></figure>

<p><img src="image-20221218010636602.png" alt="image-20221218010636602"></p>
<p><strong>网页上刷新确认</strong></p>
<p><img src="image-20221218010733995.png" alt="image-20221218010733995"></p>
<h3 id="拉取harbor镜像"><a href="#拉取harbor镜像" class="headerlink" title="拉取harbor镜像"></a>拉取harbor镜像</h3><h4 id="1-利用docker登录到harbor"><a href="#1-利用docker登录到harbor" class="headerlink" title="(1)利用docker登录到harbor"></a>(1)利用docker登录到harbor</h4><h4 id="2-在网页上点击要拉取的镜像"><a href="#2-在网页上点击要拉取的镜像" class="headerlink" title="(2)在网页上点击要拉取的镜像"></a>(2)在网页上点击要拉取的镜像</h4><p><img src="image-20221218010901675.png" alt="image-20221218010901675"></p>
<p><img src="image-20221218010912112.png" alt="image-20221218010912112"></p>
<p><img src="image-20221218010922685.png" alt="image-20221218010922685"></p>
<p>随后到终端运行复制的命令即可</p>
<h2 id="docker可视化web工具"><a href="#docker可视化web工具" class="headerlink" title="docker可视化web工具"></a>docker可视化web工具</h2><p>Portainer 是一款轻量级的应用，它提供了图形化界面，用于方便地管理Docker环境，包括单机环境和集群环境。</p>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#拉取镜像</span></span><br><span class="line">docker pull portainer/portainer</span><br><span class="line"><span class="comment">#创建文件夹并且开放文件夹权限</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/portainer &amp;&amp; <span class="built_in">chmod</span> 777 -R portainer</span><br></pre></td></tr></table></figure>

<p><strong>创建配置文件<code>docker-compose.yml</code></strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在/opt/portainer下:</span></span><br><span class="line">vim docker-compose.yml</span><br></pre></td></tr></table></figure>

<p><code>docker-compose.yml</code>文件内容</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.6&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">portainer:</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">portainer</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">portainer/portainer:latest</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">         <span class="bullet">-</span> <span class="string">&quot;9000:9000&quot;</span></span><br><span class="line">         <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">/var/run/docker.sock:/var/run/docker.sock:rw</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">/opt/portainer/data:/data:rw</span></span><br><span class="line">        <span class="attr">logging:</span></span><br><span class="line">            <span class="attr">driver:</span> <span class="string">&quot;json-file&quot;</span></span><br><span class="line">            <span class="attr">options:</span></span><br><span class="line">                <span class="attr">max-size:</span> <span class="string">&quot;10m&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>启动:</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<p><strong>访问测试</strong></p>
<p><img src="image-20221218094758456.png" alt="image-20221218094758456"></p>
<p>选择docker类型:</p>
<p><img src="image-20221218094822453.png" alt="image-20221218094822453"></p>
<p>主界面</p>
<p><img src="image-20221218094837357.png" alt="image-20221218094837357"></p>
<h3 id="单个部署"><a href="#单个部署" class="headerlink" title="单个部署"></a>单个部署</h3><h4 id="创建局域网"><a href="#创建局域网" class="headerlink" title="创建局域网"></a>创建局域网</h4><p>对应命令: <code>dicker network create 网络名 </code></p>
<p><img src="image-20221218095043425.png" alt="image-20221218095043425"></p>
<p><img src="image-20221218095054908.png" alt="image-20221218095054908"></p>
<h4 id="部署mysql"><a href="#部署mysql" class="headerlink" title="部署mysql"></a>部署mysql</h4><p><img src="image-20221218095339811.png" alt="image-20221218095339811"></p>
<p><img src="image-20221218095401453.png" alt="image-20221218095401453"></p>
<p><img src="image-20221218095445291.png" alt="image-20221218095445291"></p>
<p><img src="image-20221218095502887.png" alt="image-20221218095502887"></p>
<p><img src="image-20221218095528464.png" alt="image-20221218095528464"></p>
<p><img src="image-20221218095616371.png" alt="image-20221218095616371"></p>
<p><img src="image-20221218095627995.png" alt="image-20221218095627995"></p>
<h4 id="部署redis"><a href="#部署redis" class="headerlink" title="部署redis"></a>部署redis</h4><p>在Home页面进入 Container-&gt; Add Container</p>
<p><img src="image-20221218095811968.png" alt="image-20221218095811968"></p>
<p><img src="image-20221218095825486.png" alt="image-20221218095825486"></p>
<p><img src="image-20221218095839094.png" alt="image-20221218095839094"></p>
<p><img src="image-20221218095850255.png" alt="image-20221218095850255"></p>
<p><img src="image-20221218095901726.png" alt="image-20221218095901726"></p>
<h3 id="堆积部署"><a href="#堆积部署" class="headerlink" title="堆积部署"></a>堆积部署</h3><h4 id="1-创建堆叠容器"><a href="#1-创建堆叠容器" class="headerlink" title="1.创建堆叠容器"></a>1.创建堆叠容器</h4><p><img src="image-20221218192835688.png" alt="image-20221218192835688"></p>
<h4 id="2-命名"><a href="#2-命名" class="headerlink" title="2.命名"></a>2.命名</h4><p><img src="image-20221218192855022.png" alt="image-20221218192855022"></p>
<h4 id="3-编写配置文件"><a href="#3-编写配置文件" class="headerlink" title="3.编写配置文件"></a>3.编写配置文件</h4><p>相当于编写<code>docker-compose.yml</code>文件</p>
<p><img src="image-20221218193057218.png" alt="image-20221218193057218"></p>
<h4 id="4-启动部署"><a href="#4-启动部署" class="headerlink" title="4.启动部署"></a>4.启动部署</h4><p><img src="image-20221218193203743.png" alt="image-20221218193203743"></p>
<p><img src="image-20221218193223636.png" alt="image-20221218193223636"></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Luo Qianyou
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://lqy679.github.io/2020/01/01/Docker/" title="Docker">https://lqy679.github.io/2020/01/01/Docker/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/01/02/%E8%BF%90%E7%BB%B4%E5%B8%B8%E8%AF%86%E7%AE%80%E8%AE%B0/" rel="prev" title="运维常识简记">
                  <i class="fa fa-chevron-left"></i> 运维常识简记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/01/01/CSS3%E6%96%B0%E5%A2%9E%E7%9F%A5%E8%AF%86/" rel="next" title="CSS3新增知识">
                  CSS3新增知识 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="选择语言">
      
        <option value="zh-CN" data-href="/2020/01/01/Docker/" selected="">
          简体中文
        </option>
      
        <option value="en" data-href="/en/2020/01/01/Docker/" selected="">
          English
        </option>
      
    </select>
  </div>


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Luo Qianyou</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/LQY679" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





<!-- hexo injector body_end start -->
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js"></script>
<meting-js server="tencent" type="playlist" id="8809238545" fixed="true"  autoplay="false" loop="all" order="list" list-folded="ture" list-max-height="500px" ><!-- hexo injector body_end end --></body>
</html>
